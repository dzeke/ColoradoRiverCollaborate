#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20),
legend.position = "none")
#Reshape the data so Methods are in columns
dfInflowsWide <- dcast(dfInflowsToPlot, WaterYear ~ Method, value.var = "MeadInflow")
dfInflowsWide$Diff <-  dfInflowsWide$`USGS Gages` - dfInflowsWide$`USBR Application Program Interface`
#################
###   FIGURE 9
###   Show the correlation between USGS and USBR estimates of inflow
#################
ggplot() +
geom_point(data = dfInflowsWide, aes(x= `USBR Application Program Interface`, y=`USGS Gages`),  size = 6) + #color=Method shape=Method, size=6) +
#geom_point(data = dfInflowsWide, aes(x= WaterYear, y=Diff),  size = 6) + #color=Method shape=Method, size=6) +
#geom_point(data = dfGCFDataToUse %>% filter(WaterYear < 1990), aes(x= LeeFerryNaturalFlow, y=MeadInflow, color="Natural Flow pre 1990", shape="Natural Flow pre 1990"), size=6) +
#scale_shape_manual(values=c(17,16,16), breaks = c("USGS","Natural Flow","Natural Flow pre 1990"), labels  = c("USGS (after 1990)","Natural Flow (after 1990)","Natural Flow (before 1990)")) +
#scale_color_manual(values=c("Blue","Red","Pink"), breaks = c("USGS","Natural Flow","Natural Flow pre 1990"), labels  = c("USGS (after 1990)","Natural Flow (after 1990)","Natural Flow (before 1990)")) +
#Add 1:1 line
geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red", size = 1) +
#Add linear regression line
geom_smooth(data = dfInflowsWide, aes(x= `USBR Application Program Interface`, y=`USGS Gages`),
method = "lm",
formula = y ~ x,
geom = "smooth") +
#Add regression equation to plot
stat_regline_equation(data = dfInflowsWide, aes(x= `USBR Application Program Interface`, y=`USGS Gages`),
label.x=9, label.y=13, size = 6) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="USBR Back Calculation\n(MAF per year)", y="USGS Gages\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
#################
###   FIGURE 10
###   Show the difference between USGS and USBR methods to estimate inflow
#################
ggplot() +
#Points after 1990 in Blue and Red
#geom_point(data = dfInflowsWide, aes(x= `USBR Application Program Interface`, y=`USGS Gages`),  size = 6) + #color=Method shape=Method, size=6) +
geom_point(data = dfInflowsWide, aes(x= WaterYear, y=Diff),  size = 6) + #color=Method shape=Method, size=6) +
#geom_point(data = dfGCFDataToUse %>% filter(WaterYear < 1990), aes(x= LeeFerryNaturalFlow, y=MeadInflow, color="Natural Flow pre 1990", shape="Natural Flow pre 1990"), size=6) +
#scale_shape_manual(values=c(17,16,16), breaks = c("USGS","Natural Flow","Natural Flow pre 1990"), labels  = c("USGS (after 1990)","Natural Flow (after 1990)","Natural Flow (before 1990)")) +
#scale_color_manual(values=c("Blue","Red","Pink"), breaks = c("USGS","Natural Flow","Natural Flow pre 1990"), labels  = c("USGS (after 1990)","Natural Flow (after 1990)","Natural Flow (before 1990)")) +
#Add 1:1 line
#geom_abline(intercept = 0, slope = 1, linetype = "dash", color = red, size = 1) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Difference in Lake Mead Inflow\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
## Show the correlation matrix
mCorr <- cor(as.data.frame(dfInflowsWide %>% filter(WaterYear >= 2005, WaterYear < 2023) %>%  select(`USGS Gages`,`USBR Application Program Interface`) ))
print(paste("Correlation = ",round(mCorr[1,2],2)))
# Not working beyond here
#### Figures 6 and 7. Show the sequence average plot using Salehabadi code for Natural Flow data set and USGS data
############################################################################################################
###### Sequence Average Plot (Dotty Plot)                                                             ######
######  - creat the Sequence-Average plot (blue dots: full period,  red dots: post-yr period)         ######
######  - Add the long term average of the flow over the full and post-yr periods as horizontal lines ######
######                                                                                                ######
######  Homa Salehabadi                                                                               ######
############################################################################################################
# This may not be needed if already installed.
#install.packages("openxlsx")
library(openxlsx)
#####==================================================================================================================
##### Inputs (change them if needed) ==================================================================================
## Set working directory if necessary e.g.
# setwd("H:/Homa/PhD/Research/Works/SeqAvePlots")
##### n.lowest function: find the nth lowest value (or index) in x ====================================================
n.lowest <- function(x,n,value=TRUE){
s <- sort(x,index.return=TRUE)
if(value==TRUE)  {s$x[n]}  else  {s$ix[n]}    ## TRUE: n.lowest=value   FALSE: n.lowest=index
}
# Natural Flow Plot
## Input Files ------------------------------------------------------------------------------
#filename1 <- "R_InputData.xlsx"
#sheetname1 <-  "AnnualWYTotalNaturalFlow_LF2018"    ## Natural flow: "AnnualWYTotalNaturalFlow_LF2018"   ## Tree ring: "TR_Meko_2017-SK"
#A data frame to loop over
dfDataTypes <- data.frame(Source = c("USGS","Natural Flow"), minY = c(6,6), maxY = c(2,2))
for(iType in (1:nrow(dfDataTypes))) {
# iType <- 2
### Pull the data into the data data frame for plotting
data <- dfGCFDataToUse %>% filter(Source == dfDataTypes$Source[iType], WaterYear > 1906)
## Factor to change the current unit --------------------------------------------------------
unit_factor <- 1 #10^(-6)   ## ac-ft to MAF
## Maximum length of sequence (sequences will be from 1 to seq_yr) --------------------------
seq_yr <- 15 ## 25
## desired period ---------------------------------------------------------------------------
#yr1 <- 1990   ## NF:1906   TR:1416
#yr2 <- 2016   ## NF:2018   TR:2015
## A year to divide the period into two period.  --------------------------------------------
post_year <- 2000   ## post-year will be distinguished in plot
#desired period is the min and max water years
yr1 <- min(data$WaterYear)
yr2 <- max(data$WaterYear)
#data <- read.xlsx(filename1, sheet=sheetname1, colNames=TRUE)
#data <- read.csv(file = "GrandCanyonFlows.csv", header = TRUE, sep =",", strip.white = TRUE)
years <- yr1:yr2
n <- length(years)
#### Sequence Average plot ###########################################################################################
####   - creat the Sequence-Average plot
####   - add the long term average of the flow over the full and post-yr periods as horizontal lines
####
#### >> Check Legend if needed
## take the flow data ------------
flow <- data[ which(data[,1]==yr1):which(data[,1]==yr2) ,(4)]
## define empty matrixes -------------
Mean<- matrix(rep(NA), nrow=n , ncol=seq_yr)
lowest <- matrix(rep(NA), nrow=n , ncol=seq_yr)
lowest_index <- matrix(rep(NA), nrow=n , ncol=seq_yr)
lowest_year <- matrix(rep(NA), nrow=n , ncol=seq_yr)
## calculate the averages over the sequences---------------
## Loop: over the defined sequences
for (m_yr in 1:seq_yr){
print(m_yr)
mean_m_yr <- rep(NA)
sort <- rep(NA)
for (m in 1:(n-(m_yr-1))){
mean_m_yr[m] <- mean( flow[ m : (m+(m_yr-1)) ] )
Mean[m ,m_yr] <- mean_m_yr[m]
print(paste("m: ",m))
}
for (m in 1:(n-(m_yr-1))){
lowest[m ,m_yr] <- n.lowest( mean_m_yr,m,value=TRUE)
lowest_index[m ,m_yr] <- n.lowest(mean_m_yr,m,value=FALSE)
lowest_year[m ,m_yr] <- years[lowest_index[m ,m_yr]]
}
}
## change unit to MAF ----------------------
lowest_MAF <- lowest*unit_factor
###### Plot SeqAve (dotty plots) ==========================================================================
## the final dataframe that you want its dotty plot will be SeqAve
SeqAve <- lowest_MAF
## will be used to plot with a better scale:
#min <-  6 #floor(min(SeqAve, na.rm=TRUE))
max <- ceiling(max(SeqAve, na.rm=TRUE))
min <- dfDataTypes$minY[iType]
#max <- dfDataTypes$maxY[iType]
##### plot -----------------------------------------------------------
x <- c(1:seq_yr)
par(mar=c(5, 4, 3, 2) + 0.2 , mgp=c(2.5, 1, 0) )
## 1- For natural flow run this:
plot(x, SeqAve[1,], col="white", ylim=c(min, max) , xlim=c(1, seq_yr+1), xaxt="n" ,yaxt="n",
pch=16, cex=0.6, xlab="Length of sequence (year)", ylab="Lake Mead Inflow\n(maf per year)", cex.lab=1.3,
main=paste0("Lake Mead Inflow),  Period: " ,yr1,"-",yr2,paste0("\n",dfDataTypes$Source[iType]," Data")) )  ## , cex.main=1.3
### axis of the plot -------
axis(1, at=seq(1,seq_yr,1), cex.axis=1)
# axis(2, at=seq((min-2),max,0.25), cex.axis=1, las=1)  ## las=1 to rotate the y lables
axis(2, at=seq((min-2),max,1), cex.axis=1, las=1)  ## las=1 to rotate the y lables
### plot dots and seperate them to blue and red ones ---------
## full period
for (j in 1:seq_yr){
for (i in 1:(n-(j-1))){  #1:n
points(j, SeqAve[i,j], col= "lightskyblue2" ,pch=1, cex=0.5, lwd=1)
}
}
## specify post-yr period
for (j in 1:seq_yr){
for (i in 1:(n-(j-1))){  #1:n
if ( lowest_year[i,j]>=post_year) {
points(j, SeqAve[i,j], col= "black" ,bg="red" ,pch=21, cex=0.7, lwd=0.2)
}
}
}
### add a line representing the long-term average of flow during the full period -----------
ave_all <- mean(flow)* unit_factor
abline (ave_all, 0, col="steelblue2", lwd=1.2)
### add a line representing the long-term average of flow during the post-yr period
while(post_year<=yr2){
ave_post <- mean(flow[(which(years==post_year) : which(years==yr2))] ) * unit_factor
abline (ave_post, 0, col="red", lwd=1.2)
break}
### lable the two lines of long-term average -----------
if(post_year<=yr2){
if(ave_all>ave_post){
text((seq_yr+0.2),(ave_all+0.3), labels= paste(round(ave_all, digits=2)), pos = 4, cex=1, col="dodgerblue3", xpd=TRUE)  ##, font=2
text((seq_yr+0.2),(ave_post-0.4), labels= paste(round(ave_post, digits=2)), pos = 4, cex=1, col="red", xpd=TRUE)
}
if(ave_all<ave_post){
text((seq_yr+0.2),(ave_all-0.4), labels= paste(round(ave_all, digits=2)), pos = 4, cex=1, col="dodgerblue3", xpd=TRUE)  ##, font=2
text((seq_yr+0.2),(ave_post+0.4), labels= paste(round(ave_post, digits=2)), pos = 4, cex=1, col="red", xpd=TRUE)
}
} else {
text((seq_yr+0.2),(ave_all+0.3), labels= paste(round(ave_all, digits=2)), pos = 4, cex=1, col="dodgerblue3", xpd=TRUE)
}
### lable the first and second lowest SeqAve ----------
text(SeqAve[1,]~x, labels=lowest_year[1,], pos = 1, cex=0.6, col="black", srt=0) ## the lowest     (vertical text: srt=90)
text(SeqAve[2,]~x, labels=lowest_year[2,], pos = 2, cex=0.5, col="gray47", srt=0)  ## the second lowest
### 1- Legend for natural flow 1906-2018 -----------
legend("topright", legend=c(paste0("Full Period (",yr1,"-",yr2,")"),paste0("Post-",post_year,"(",post_year,"-",yr2,")"), paste0("Long term mean (",yr1,"-",yr2,")"),  paste0("Long term mean (",post_year,"-", yr2,")")),
col=c("lightskyblue3","black","steelblue2","red"), pt.bg=c(NA,"red", NA,NA) , pch=c(1,21, NA, NA), pt.cex=c(0.6, 0.8),
lwd=1,  lty=c(0,0,1,1), inset=c(0.05, 0.03), bty = "n")
}
ggplot() +
#Evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = EvaporationFromTable, color = "Evaporation"),  size = 6) + #color=Method shape=Method, size=6) +
#Add error bars to data points
#Mead
geom_errorbar(data=dfUSBR_API_Agg, aes(x=WaterYear, ymin=EvaporationFromTable - EvaporationRange/2, ymax=EvaporationFromTable + EvaporationRange/2), width=.005,
position=position_dodge(0.2), color="black", show.legend = FALSE) +
#Inflow
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow"), size = 6) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water"),  size = 6) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
#Add 1:1 line
#geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red", size = 1) +
#Add linear regression line
#geom_smooth(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#           method = "lm",
#           formula = y ~ x,
#            geom = "smooth") +
#Add regression equation to plot
#stat_regline_equation(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#                      label.x= mean(dfUSBR_API_Agg$Evaporation), label.y=mean(dfUSBR_API_Agg$EvaporationFromTable), size = 6) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = EvaporationFromTable, color = "Evaporation"),  size = 6) + #color=Method shape=Method, size=6) +
#Add error bars to data points
#Mead
geom_errorbar(data=dfUSBR_API_Agg, aes(x=WaterYear, ymin=EvaporationFromTable - EvaporationRange/2, ymax=EvaporationFromTable + EvaporationRange/2), width=.005,
position=position_dodge(0.2), color="black", show.legend = FALSE) +
#Inflow
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow"), size = 6) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water"),  size = 6) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
scale_fill_manual(values = cColorsToPlot)
#Add 1:1 line
#geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red", size = 1) +
#Add linear regression line
#geom_smooth(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#           method = "lm",
#           formula = y ~ x,
#            geom = "smooth") +
#Add regression equation to plot
#stat_regline_equation(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#                      label.x= mean(dfUSBR_API_Agg$Evaporation), label.y=mean(dfUSBR_API_Agg$EvaporationFromTable), size = 6) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = EvaporationFromTable, color = "Evaporation"),  size = 6) + #color=Method shape=Method, size=6) +
#Add error bars to data points
#Mead
geom_errorbar(data=dfUSBR_API_Agg, aes(x=WaterYear, ymin=EvaporationFromTable - EvaporationRange/2, ymax=EvaporationFromTable + EvaporationRange/2), width=.005,
position=position_dodge(0.2), color="black", show.legend = FALSE) +
#Inflow
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow"), size = 6) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water"),  size = 6) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
scale_fill_manual(values = cColorsToPlot) +
#Add 1:1 line
#geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red", size = 1) +
#Add linear regression line
#geom_smooth(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#           method = "lm",
#           formula = y ~ x,
#            geom = "smooth") +
#Add regression equation to plot
#stat_regline_equation(data = dfUSBR_API_Agg, aes(x= Evaporation, y = EvaporationFromTable),
#                      label.x= mean(dfUSBR_API_Agg$Evaporation), label.y=mean(dfUSBR_API_Agg$EvaporationFromTable), size = 6) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = EvaporationFromTable, color = "Evaporation", shape = 15),  size = 6) + #color=Method shape=Method, size=6) +
#Add error bars to data points
#Mead
geom_errorbar(data=dfUSBR_API_Agg, aes(x=WaterYear, ymin=EvaporationFromTable - EvaporationRange/2, ymax=EvaporationFromTable + EvaporationRange/2), width=.005,
position=position_dodge(0.2), color="black", show.legend = FALSE) +
#Inflow
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", shape = 16), size = 6) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", shape = 17),  size = 6) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
scale_fill_manual(values = cColorsToPlot) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = EvaporationFromTable, color = "Evaporation"), shape = 15, size = 6) + #color=Method shape=Method, size=6) +
#Add error bars to data points
#Mead
geom_errorbar(data=dfUSBR_API_Agg, aes(x=WaterYear, ymin=EvaporationFromTable - EvaporationRange/2, ymax=EvaporationFromTable + EvaporationRange/2), width=.005,
position=position_dodge(0.2), color="black", show.legend = FALSE) +
#Inflow
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow"), shape = 16, size = 6) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_point(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water"),  shape = 17,  size = 6) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
scale_fill_manual(values = cColorsToPlot) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#geom_area(data = dfICSDeposit, aes(x=Year, y = TotalDeposit, color = "ICS Deposit", fill = "ICSDeposit"))
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend("Dataset"), shape = guide_legend("Dataset")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#geom_area(data = dfICSDeposit, aes(x=Year, y = TotalDeposit, color = "ICS Deposit", fill = "ICSDeposit"))
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit, color = "ICS Deposit", fill = "ICSDeposit"), size = 6)
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit/1e6, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit/1e6, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed") +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit/1e6, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed", size = 2) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit/1e6, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed", size = 2) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
ylim(7, 13) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))
ggplot() +
#Inflow
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow, color = "Inflow", fill="Inflow")) + #color=Method shape=Method, size=6) +
#Available water = Inflow - evaporation
geom_area(data = dfUSBR_API_Agg, aes(x= WaterYear, y = MeadInflow - Evaporation, color = "Available Water", fill="Available Water")) + #color=Method shape=Method, size=6) +
geom_point(data = dfICSDeposit, aes(x=Year, y = 9 - TotalDeposit/1e6, color = "ICS Deposit", fill = "ICSDeposit"), size = 6) +
#Add line for 9.0 maf
geom_hline(yintercept = 9, color="red", linetype = "dashed", size = 2) +
# Set x-axis limits
xlim(min(dfUSBR_API_Agg$WaterYear),max(dfUSBR_API_Agg$WaterYear)) +
#ylim(7, 13) +
#Make one combined legend
guides(color = guide_legend(""), fill = guide_legend("")) +
#facet_wrap( ~ Source) +
labs(x="", y="Volume\n(MAF per year)") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme_bw() +
theme(text = element_text(size=20))

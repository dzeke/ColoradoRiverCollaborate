"0",""
"0","# ICS-Plots.r"
"0","#"
"0","# Make stacked bar graph of state Intentionally Created Surplus holdings by year"
"0","#"
"0","# Data is USBR Water Accounting Reports: https://www.usbr.gov/lc/region/g4000/wtracct.html in source Excel file"
"0","# Please report bugs/feedback to:"
"0","#"
"0","# Updated June 23, 2020 to include annual deposits and withdraws as year-to-year differnces"
"0","#"
"0","# Updated April 4, 2021 to look at ICS to DCP conversion"
"0","#"
"0","# Updated June 10, 2021 to include 2020 data."
"0","#"
"0","# David E. Rosenberg"
"0","# June 10, 2021"
"0","# "
"0","# Utah State University"
"0","# david.rosenberg@usu.edu"
"0",""
"0","rm(list = ls())  #Clear history"
"0",""
"0","# Load required libraies"
"0",""
"0","if (!require(tidyverse)) { "
"0","  install.packages(""tidyverse"", repos=""https://cran.cnr.berkeley.edu/"", verbose = TRUE) "
"0","  library(tidyverse) "
"0","}"
"0",""
"0","if (!require(readxl)) { "
"0","  install.packages(""readxl"", repos=""http://cran.r-project.org"") "
"0","  library(readxl) "
"0","}"
"0",""
"0","  "
"0","if (!require(RColorBrewer)) { "
"0","  install.packages(""RColorBrewer"",repos=""http://cran.r-project.org"") "
"0","  library(RColorBrewer) # "
"0","}"
"0",""
"0","if (!require(dplyr)) { "
"0","  install.packages(""dplyr"",repos=""http://cran.r-project.org"") "
"0","  library(dplyr) # "
"0","}"
"0",""
"0","if (!require(expss)) { "
"0","  install.packages(""expss"",repos=""http://cran.r-project.org"") "
"0","  library(expss) # "
"0","}"
"0",""
"0","if (!require(reshape2)) { "
"0","  install.packages(""reshape2"", repos=""http://cran.r-project.org"") "
"0","  library(reshape2) "
"0","}"
"0",""
"0","if (!require(pracma)) { "
"0","  install.packages(""pracma"", repos=""http://cran.r-project.org"") "
"0","  library(pracma) "
"0","}"
"0",""
"0","if (!require(lubridate)) { "
"0","  install.packages(""lubridate"", repos=""http://cran.r-project.org"") "
"0","  library(lubridate) "
"0","}"
"0",""
"0","if (!require(directlabels)) { "
"0","  install.packages(""directlabels"", repo=""http://cran.r-project.org"")"
"0","  library(directlabels) "
"0","}"
"0",""
"0","if (!require(plyr)) { "
"0","  install.packages(""plyr"", repo=""http://cran.r-project.org"")"
"0","  library(plyr) "
"0","}"
"0",""
"0","# if (!require(ggplot)) { "
"0","#   install.packages(""ggPlot"", repo=""http://cran.r-project.org"", dependencies = T)"
"0","#   library(ggplot) "
"0","# }"
"0",""
"0","if (!require(stringr)) { "
"0","  install.packages(""stringr"", repo=""http://cran.r-project.org"")"
"0","  library(stringr) "
"0","}"
"0",""
"0",""
"0",""
"0","# Load Data"
"0",""
"0","# Read in state balances each year"
"0","sExcelFile <- 'IntentionallyCreatedSurplus-Summary.xlsx'"
"0","dfICSBalance <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""B6:G19"")"
"0","dfICStoDCP <- read_excel(sExcelFile, sheet = ""ICStoDCP"",  range = ""A2:M14"")"
"1","[38;5;232mNew names:
[36m*[38;5;232m `AZ` -> `AZ...5`
[36m*[38;5;232m `CA` -> `CA...6`
[36m*[38;5;232m `NV` -> `NV...7`
[36m*[38;5;232m `AZ` -> `AZ...8`
[36m*[38;5;232m `CA` -> `CA...9`
[36m*[38;5;232m `NV` -> `NV...10`
[36m*[38;5;232m `AZ` -> `AZ...11`
[36m*[38;5;232m `CA` -> `CA...12`
[36m*[38;5;232m `NV` -> `NV...13`[39m
"
"0","dfLimits <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""A25:F28"")"
"1","[38;5;232mNew names:
[36m*[38;5;232m `` -> `...5`[39m
"
"0","# #Read in max balance"
"0","# nMaxBalance <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""A25:F28"")"
"0","# # Read in state balances each year"
"0","# sExcelFile <- 'IntentionallyCreatedSurplus-Summary.xlsx'"
"0","# dfICSBalance <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""B6:G17"")"
"0","# dfICStoDCP <- read_excel(sExcelFile, sheet = ""ICStoDCP"",  range = ""A2:M14"")"
"0","# dfLimits <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""A23:F26"")"
"0",""
"0","#Read in max balance"
"0","nMaxBalance <- read_excel(sExcelFile, sheet = ""Sheet1"",  range = ""A23:F26"")"
"1","[38;5;232mNew names:
[36m*[38;5;232m `` -> `...2`
[36m*[38;5;232m `` -> `...3`
[36m*[38;5;232m `` -> `...4`
[36m*[38;5;232m `` -> `...5`
[36m*[38;5;232m `` -> `...6`[39m
"
"0","#create a data frame"
"0","#dfMaxBalance <- data.frame(Year=dfICSBalance$Year, MaxBal = nMaxBalance$Total[2])"
"0",""
"0","#Read in max deposit per year"
"0","dfMaxAnnualAmounts <- data.frame(Year=dfICSBalance$Year, MaxDeposit = nMaxBalance$Total[1], MaxWithdraw = nMaxBalance$Total[3])"
"2","Error in data.frame(Year = dfICSBalance$Year, MaxDeposit = nMaxBalance$Total[1],  : 
  arguments imply differing number of rows: 13, 0
"
